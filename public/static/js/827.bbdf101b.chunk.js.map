{"version":3,"file":"static/js/827.bbdf101b.chunk.js","mappings":"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","sources":["pages/admin/Post.jsx","utils/adminApi.js","utils/http.js"],"sourcesContent":["import { useEffect, useState } from 'react';\nimport { PostApi, PostSaveApi, PostDelApi } from '../../utils/adminApi';\nimport {\n  Table,\n  Button,\n  Modal,\n  Upload,\n  message,\n  Form,\n  Input,\n  Select,\n} from 'antd';\nimport { PlusOutlined } from '@ant-design/icons';\nconst { Column } = Table;\nconst { Option } = Select;\nconst { TextArea } = Input;\n\nconst Post = () => {\n  const [tableData, setTableData] = useState();\n  const [visible, setVisible] = useState(false);\n  const [imageUrl, setImageUrl] = useState(null);\n  const [form] = Form.useForm();\n\n  useEffect(() => {\n    PostApi().then((res) => {\n      setTableData(\n        res.data.map((item) => ({\n          ...item,\n          _id: item._id.slice(0, 7),\n          id: item._id,\n          createdAt: item.createdAt.replace(/[TZ]/g, ' '),\n          updatedAt: item.updatedAt.replace(/[TZ]/g, ' '),\n        }))\n      );\n    });\n  }, []);\n\n\n  const edit = (record) => {\n    form.setFieldsValue(record);\n    setImageUrl(record.imageUrl);\n    setVisible(true);\n  };\n  const del = (record) => {\n    PostDelApi(record.id).then((res) => {\n      const newTableData = tableData.filter((item) => item.id !== record.id);\n      setTableData(newTableData);\n    });\n  };\n\n  const onChange = (info) => {\n    if (info.file.status === 'done') {\n      message.success('文件上传成功');\n      setImageUrl(info.file.response);\n    } else if (info.file.status === 'error') {\n      message.error('文件上传失败');\n    }\n  };\n\n  const onFinish = (value) => {\n    PostSaveApi({ ...value, imageUrl }).then((res) => {\n      message.success('保存成功');\n      onCancel();\n      const swapData = tableData.filter((item) => item.id !== res.data._id);\n      setTableData([\n        ...swapData,\n        {\n          ...res.data,\n          _id: res.data._id.slice(0, 7),\n          id: res.data._id,\n        },\n      ]);\n    });\n  };\n\n  const onCancel = () => {\n    setVisible(false);\n    setImageUrl(null);\n    form.resetFields();\n  };\n  return (\n    <>\n      <Button\n        type=\"primary\"\n        className=\"bg-blue-600\"\n        onClick={() => setVisible(true)}\n      >\n        发布公告\n      </Button>\n      <Modal\n        title=\"发布公告\"\n        centered\n        visible={visible}\n        onCancel={onCancel}\n        width={1000}\n        keyboard={false}\n        maskClosable={false}\n        footer={[]}\n      >\n        <Form\n          labelCol={{ span: 4 }}\n          form={form}\n          name=\"control-hooks\"\n          onFinish={onFinish}\n        >\n          <Form.Item name=\"id\" style={{ display: 'none' }}>\n            <Input />\n          </Form.Item>\n          <Form.Item name=\"name\" label=\"标题\" rules={[{ required: true }]}>\n            <Input />\n          </Form.Item>\n          <Form.Item name=\"category\" label=\"类别\" rules={[{ required: true }]}>\n            <Select placeholder=\"请选择公告类别\" allowClear>\n              <Option value={1}>新手入门</Option>\n              <Option value={2}>每日早报</Option>\n              <Option value={3}>会员答疑</Option>\n              <Option value={4}>项目教程</Option>\n            </Select>\n          </Form.Item>\n          <Form.Item name=\"detail\" label=\"详情\">\n            <TextArea rows={4} placeholder=\"输入公告内容\" />\n          </Form.Item>\n          <Form.Item label=\"缩略图\">\n            <Upload\n              className=\"flex justify-center items-center\"\n              name=\"file\"\n              action={process.env.REACT_APP_UPLOAD_SERVER}\n              headers={\n                localStorage.getItem('__web_token')\n                  ? { Authorization: `Bearer ${localStorage.__web_token}` }\n                  : null\n              }\n              showUploadList={false}\n              onChange={onChange}\n            >\n              {imageUrl ? (\n                <img\n                  src={process.env.REACT_APP_SERVER + imageUrl}\n                  alt=\"avatar\"\n                  className=\" w-72 h-24 bg-red-400\"\n                />\n              ) : (\n                <div className=\"flex justify-center items-center w-24 h-24 bg-red-400\">\n                  <PlusOutlined />\n                </div>\n              )}\n            </Upload>\n          </Form.Item>\n          <Form.Item wrapperCol={{ span: 4, offset: 4 }}>\n            <Button type=\"link\" htmlType=\"submit\">\n              保存\n            </Button>\n          </Form.Item>\n        </Form>\n      </Modal>\n\n      <Table dataSource={tableData} rowKey=\"id\">\n        <Column title=\"ID\" dataIndex=\"_id\" />\n        <Column title=\"标题\" dataIndex=\"name\" />\n        <Column\n          title=\"类别\"\n          dataIndex=\"category\"\n          render={(_, record) => (\n            <>\n              {record.category === 1 ? <p>新手入门</p> : null}\n              {record.category === 2 ? <p>每日早报</p> : null}\n              {record.category === 3 ? <p>会员答疑</p> : null}\n              {record.category === 4 ? <p>项目教程</p> : null}\n            </>\n          )}\n        />\n        <Column title=\"添加时间\" dataIndex=\"createdAt\" />\n        <Column title=\"最后修改时间\" dataIndex=\"updatedAt\" />\n        <Column\n          title=\"操作\"\n          dataIndex=\"\"\n          render={(_, record) => (\n            <div className=\"flex gap-1\">\n              <Button type=\"link\" onClick={() => edit(record)}>\n                修改\n              </Button>\n              <Button type=\"link\" onClick={() => del(record)}>\n                删除\n              </Button>\n            </div>\n          )}\n        />\n      </Table>\n    </>\n  );\n};\n\nexport default Post;\n","import http from './http'\n\n\nexport const LoginApi = (model) => http.post('/admin/login', model)\nexport const RegisterApi = (model) => http.post('/admin/register', model)\nexport const CaptchaApi = () => http.get('/common/captcha')\n\nexport const DashBoardApi = () => http.get('/admin/info/dashboard')\n\nexport const UserListApi = () => http.get('/admin/user/list')\nexport const UserBanApi = (id) => http.get('/admin/user/' + id)\nexport const UserEditApi = (model) => http.post('/admin/user', model)\nexport const UserDelApi = (id) => http.delete('/admin/user/' + id)\n\nexport const RostateApi = () => http.get('/admin/info/rotate')\nexport const RostateSaveApi = (model) => http.post('/admin/info/rotate', model)\nexport const RostateDelApi = (id) => http.delete('/admin/info/rotate/' + id)\n\nexport const PostApi = () => http.get('/admin/info/post')\nexport const PostSaveApi = (model) => http.post('/admin/info/post', model)\nexport const PostDelApi = (id) => http.delete('/admin/info/post/' + id)\n\nexport const AboutApi = () => http.get('/admin/info/about')\nexport const AboutSaveApi = (model) => http.post('/admin/info/about', model)\n\nexport const ProductApi = () => http.get('/admin/product')\nexport const ProductSaveApi = (model) => http.post('/admin/product', model)\nexport const ProductDelApi = (id) => http.delete('/admin/product/' + id)\n\n","import Axios from 'axios';\nimport { toast } from 'react-toastify';\n\nconst http = Axios.create({\n  baseURL: process.env.REACT_APP_API_SERVER,\n  withCredentials: true,\n});\n\nhttp.interceptors.request.use(\n  (config) => {\n    if (localStorage.__web_token) {\n      config.headers.Authorization = 'Bearer ' + localStorage.__web_token;\n    }\n    if (localStorage.i18nextLng) {\n      config.headers['Accept-Language'] = localStorage.i18nextLng;\n    }\n    return config;\n  },\n  (err) => {\n    return Promise.reject(err);\n  }\n);\n\nhttp.interceptors.response.use(\n  (res) => {\n    if (res.data.message) {\n      toast.success(res.data.message);\n    }\n    return res;\n  },\n  (err) => {\n\t\t\n\t\t\n    if (err.response.status === 401) {\n      localStorage.removeItem('__web_token');\n\t\t\t\n      if (\n        window.location.pathname.indexOf('login') === -1 && \n\t\t\t\t\twindow.location.pathname.indexOf('register') === -1\n\t\t\t) {\n        window.location.hash = '/login';\n      }\n    }\n\n    if (err.response.data) {\n      console.log(err.response.data);\n\n      toast.error(err.response.data.message);\n      return Promise.reject(err);\n    }\n    return Promise.reject(err);\n  }\n);\n\nexport default http;\n"],"names":["Column","Table","Option","Select","TextArea","Input","useState","tableData","setTableData","visible","setVisible","imageUrl","setImageUrl","Form","form","useEffect","PostApi","then","res","data","map","item","_id","slice","id","createdAt","replace","updatedAt","onCancel","resetFields","type","className","onClick","title","centered","width","keyboard","maskClosable","footer","labelCol","span","name","onFinish","value","PostSaveApi","message","swapData","filter","style","display","label","rules","required","placeholder","allowClear","rows","action","process","headers","localStorage","getItem","Authorization","__web_token","showUploadList","onChange","info","file","status","response","src","alt","wrapperCol","offset","htmlType","dataSource","rowKey","dataIndex","render","_","record","category","setFieldsValue","edit","PostDelApi","newTableData","del","LoginApi","model","http","RegisterApi","CaptchaApi","DashBoardApi","UserListApi","UserBanApi","UserEditApi","UserDelApi","RostateApi","RostateSaveApi","RostateDelApi","AboutApi","AboutSaveApi","ProductApi","ProductSaveApi","ProductDelApi","Axios","baseURL","withCredentials","interceptors","request","use","config","i18nextLng","err","Promise","reject","toast","removeItem","window","location","pathname","indexOf","hash","console","log"],"sourceRoot":""}